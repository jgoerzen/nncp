@node Новости
@section Новости

@node Релиз 8.8.2
@subsection Релиз 8.8.2
@itemize

@item
Обновлена библиотека для работы с Yggdrasil, а также несколько других.

@end itemize

@node Релиз 8.8.1
@subsection Релиз 8.8.1
@itemize

@item
Исправлено падение @command{nncp-daemon} при неопознанном подключении и
включённом @option{-autotoss}.

@item
Обновлены зависимые библиотеки.

@end itemize

@node Релиз 8.8.0
@subsection Релиз 8.8.0
@itemize

@item
Исправлена невозможность сборки под Go 1.19.

@item
Минимальная требуемая версия Go 1.17.

@item
Обновлены зависимые библиотеки.

@end itemize

@node Релиз 8.7.2
@subsection Релиз 8.7.2
@itemize

@item
Более интуитивное, понятное и немного более гибкое поведение @command{nncp-rm}.

@item
@command{nncp-rm} также удаляет соответствующий @file{hdr/} файл для
каждого удалённого пакета.

@end itemize

@node Релиз 8.7.1
@subsection Релиз 8.7.1
@itemize

@item
@command{nncp-xfer} теперь корректно проверяет наличие @file{seen/}
файлов для входящих пакетов.

@end itemize

@node Релиз 8.7.0
@subsection Релиз 8.7.0
@itemize

@item
@command{nncp-ack} не подтверждает ACK-пакеты, предотвращая бесконечную
петлю из ACK-ов.

@item
В прошлом, @command{nncp-ack} не удаляла соответствующие @file{hdr/} файлы.

@item
@command{nncp-rm} теперь берёт список пакетов из @code{stdin}, при
использовании @option{-pkt} опции.

@item
@command{nncp-ack} теперь генерирует список ACK пакетов, которые были
созданы, что может использоваться в качестве ввода для @command{nncp-rm}
команды, чтобы удалить исходящие ACK пакеты.

@end itemize

@node Релиз 8.6.0
@subsection Релиз 8.6.0
@itemize

@item
@command{nncp-xfer} проверяет сходится ли контрольная сумма
скопированного локально пакета и исходного.

@item
@command{nncp-call} имеет плохой код возврата если в очередях на приём и
отправку остаются незаконченные задания.

@item
Появилась @command{nncp-ack} команда, которая отправляет явное
подтверждение доставки пакета (ACK пакет). Это подтверждение удаляет
упомянутый пакет из исходящего spool-а.

@item
Появилась возможность отключения @code{fsync} операции
@env{$NNCPNOSYNC=1} переменной окружения.

@item
Добавлены разнообразные индексы в документации, что должно помочь при
поиске в ней.

@end itemize

@node Релиз 8.5.0
@subsection Релиз 8.5.0
@itemize

@item
Исправлена работоспособность @command{nncp-bundle}.

@item
По ошибке @option{-mcd-wait} опция у @command{nncp-call} была включена
по умолчанию.

@item
Возможность переопределять внутренний timeout по умолчанию для протокола
синхронизации через @env{$NNCPDEADLINE} переменную окружения. Может быть
полезно для каналов с очень большими задержками.

@item
NNCP собирается на OpenBSD.

@end itemize

@node Релиз 8.4.0
@subsection Релиз 8.4.0
@itemize

@item
Имена интерфейсов относящихся к multicast (@code{mcd-listen} и
@code{mcd-send} опции конфигурации) теперь являются регулярными
выражениями. По умолчанию @command{nncp-cfgnew} не комментирует
их теперь и прописывает @code{.*} имя интерфейса.

@item
У @command{nncp-call} команды появился @option{-mcd-wait} аргумент,
позволяющий дожидаться multicast сообщения об адресе ноды.

@item
@command{nncp-file} команда пропускает всё что не является регулярным
файлом или директорией во время создания pax-архива.

@end itemize

@node Релиз 8.3.0
@subsection Релиз 8.3.0
@itemize

@item
Исправлена возможность сборки на 32-бит системах.

@end itemize

@node Релиз 8.2.0
@subsection Релиз 8.2.0
@itemize

@item
Yggdrasil использует IPv6+TCP сетевой стэк написанный полностью на Go,
вместо голого μTP транспортного протокола, делая возможным работу в
качестве обычного TCP сервера внутри overlay сети.

@item
Конфигурационные строки Yggdrasil вида @code{prv;bind1,bind2;pub@dots{}}
заменены на URL-подобные (@code{yggdrasils://PRV?bind=BIND1&bind=BIND2&pub=PUB}).

@item
Возможно передавать параметры Yggdrasil конфигурации связанные с multicast.

@item
@command{nncp-daemon} может слушать одновременно и на TCP и на
Yggdrasil-управляемом сокетах.

@item
Слушание на endpoint сокете для пиринга в @command{nncp-daemon}
опционально -- вы можете быть доступны и через связь с peer-ами.

@end itemize

@node Релиз 8.1.0
@subsection Релиз 8.1.0
@itemize

@item
@command{nncp-cfgdir} команда не требует обязательного наличия
@code{self} секции конфигурационного файла.

@item
Появилась возможность работы в качестве клиента overlay сети Yggdrasil,
используя online протокол поверх неё.

@end itemize

@node Релиз 8.0.2
@subsection Релиз 8.0.2
@itemize

@item
Исправлена возможность отправки мультивещательных пакетов.

@end itemize

@node Релиз 8.0.1
@subsection Релиз 8.0.1
@itemize

@item
Исправлено некорректное вычисление @code{freq.chunked} значения, при
отсутствии которого всё равно форсированно включалась chunked передача.

@item
Исправлено некорректное вычисление значения полного размера файла в
@file{.nncp.meta}.

@end itemize

@node Релиз 8.0.0
@subsection Релиз 8.0.0
@itemize

@item
@strong{Несовместимое} изменение формата зашифрованных пакетов: размеры
полезной нагрузки и дополнения посылаются прямо внутри зашифрованного
потока. Это даёт возможность потоково создавать шифрованные пакеты, без
знания размеров заранее, без создания временного файла или буферизации в
памяти.

@item
Производится корректная проверка дополнения зашифрованного пакета. Это
не критичная проблема, но прежде ни размер, ни значение дополнения не
были аутентифицированы, позволяя циклично откусывать по байту с конца и
узнавать размер полезной нагрузки, наблюдая за реакцией по обработке
такого зашифрованного пакета.

@item
@command{nncp-exec} больше не имеет @option{-use-tmp} опции, из-за
совместимого с потоковой работой формата зашифрованных пакетов.

@item
У @command{nncp-file} и @command{nncp-exec} команд появилась опция
@option{-maxsize}, ограничивающая максимальный результирующий размер
зашифрованного пакета (возвращая ошибку если он превышен). Может быть
полезно, так как размер полезной нагрузки может быть неизвестен заранее.

@end itemize

@node Релиз 7.7.0
@subsection Релиз 7.7.0
@itemize

@item
Экспериментальная поддержка @code{kqueue} и @code{inotify} оповещений об
изменениях в spool директориях, для сокращения накладных расходов на их
частое чтение.

@item
@file{.seen} и @file{.hdr} файлы находятся в @file{seen/} и @file{hdr/}
поддиректориях теперь, дабы ускорить сканирование spool областей.
Необходима миграция текущих файлов:

@example
$ find $NNCPSPOOL -type f -name "*.hdr" -exec rm @{@} +

$ find $NNCPSPOOL -type d -name rx | while read rx ; do
    cd $rx
    mkdir -p seen
    find . -type f -name "*.seen" | while read fn ; do
        mv $fn seen/$@{fn%.seen@}
    done
done

$ find $NNCPSPOOL -type d -name area | while read area ; do
    find $area -type f -name "*.seen" | while read fn ; do
        mv $fn $@{fn%.seen@}
    done
done
@end example

@end itemize

@node Релиз 7.6.0
@subsection Релиз 7.6.0
@itemize

@item
Журналирование может производиться в назначенный открытый файловый
дескриптор (@env{$NNCPLOG=FD:5} например).
Что дружелюбно к использованию под @command{daemontools}.

@item
Добавлены дополнительные проверки наличия публичных ключей в
конфигурационном файле, предотвращающие падения некоторых команд.

@end itemize

@node Релиз 7.5.1
@subsection Релиз 7.5.1
@itemize

@item
NNCP собирается на NetBSD.

@end itemize

@node Релиз 7.5.0
@subsection Релиз 7.5.0
@itemize

@item
@command{nncp-daemon} соблюдает UCSPI-TCP интерфейс, благодаря чему в
журнале будет присутствовать адрес удалённой системы (при запуске под
совместимой утилитой). Желательно применять @option{-ucspi} опцию вместо
@option{-inetd}.

@item
@command{nncp-call} может быть UCSPI-TCP клиентом, используя
@option{-ucspi} опцию.

@item
Не выходить если не получается слушать на каком-либо MCD сетевом
интерфейсе -- только предупреждать об ошибке.

@end itemize

@node Релиз 7.4.0
@subsection Релиз 7.4.0
@itemize

@item
Исправлена работоспособность MCD при одновременном использовании
@command{nncp-daemon} и @command{nncp-caller}.

@end itemize

@node Релиз 7.3.2
@subsection Релиз 7.3.2
@itemize

@item
@command{hjson-cli} утилита теперь собирается в vendor-режиме.

@end itemize

@node Релиз 7.3.1
@subsection Релиз 7.3.1
@itemize

@item
Исправлена проблема с возможно остающимся открытым файловым
дескриптором в online командах.

@item
Существенно снижено потребление памяти MTH хэширования.

@end itemize

@node Релиз 7.3.0
@subsection Релиз 7.3.0
@itemize

@item
Поправлены проблемы работоспособности на 32-бит системах с большими файлами.

@item
Возможность использовать конфигурацию в виде директории с набором
файлов. Появилась команда @command{nncp-cfgdir}.

@end itemize

@node Релиз 7.2.1
@subsection Релиз 7.2.1
@itemize

@item
Небольшие оптимизации в online командах.

@end itemize

@node Релиз 7.2.0
@subsection Релиз 7.2.0
@itemize

@item
Появилась @command{nncp-trns} команда для ручного создания транзитных пакетов.

@item
Если у целевой ноды транзитного пакета задан @option{via} маршрут, то
использовать его, а не игнорировать.

@item
Не отправлять multicast пакет оригинатору сообщения, очевидно точно
видящего свой собственный пакет.

@item
Намного меньшее потребление памяти во время MTH хэширования когда
смещение равно нулю: когда пакет не является докачиванием, а например
проверяется @command{nncp-check} командой.

@end itemize

@node Релиз 7.1.1
@subsection Релиз 7.1.1
@itemize

@item
Исправлено падение при @code{fsync} директорий после создания @file{.seen} файлов.

@end itemize

@node Релиз 7.1.0
@subsection Релиз 7.1.0
@itemize

@item
Появилась возможность мультивещательной (multicast) рассылки пакетов.
Реализовано всего лишь дополнительным типом простых пакетов и изменением
@command{nncp-toss}, @command{nncp-file} и @command{nncp-exec} команд.

@item
Исправлена работоспособность @command{nncp-file} и @command{nncp-exec}
команд использующих временный файл (@code{stdin} и @option{-use-tmp}).

@item
Исправлен пропадающий плохой код возврата в @command{nncp-exec} команде.

@item
Исправлено некорректное генерирование @file{.hdr} при использовании
транзитных пакетов.

@item
У @command{nncp-rm} команды появилась @option{-all} опция, применяемая
ко всем нодам сразу.

@item
У @command{nncp-check} команды появилась @option{-cycle} опция, вводящая
проверку в бесконечный цикл.

@item
У @command{nncp-rm} команды можно указывать alias-ы имён нод.

@item
@command{nncp-pkt} может парсить @file{.hdr} файлы.

@end itemize

@node Релиз 7.0.0
@subsection Релиз 7.0.0
@itemize

@item
Минимальная требуемая версия Go 1.13.

@item
Хэширование с BLAKE3 на базе деревьев Меркле (Merkle Tree Hashing, MTH)
используется вместо BLAKE2b. Из-за этого, обратно @strong{несовместимое}
изменение формата шифрованных файлов (всего что находится в spool
области) и формата @file{.meta} файла при chunked передаче.

Текущая реализация далека от оптимальной: в ней нет распараллеливания
вычислений и имеет повышенное потребление памяти: около 512 KiB на
каждый 1 GiB данных файла. Будущая оптимизация производительности и
потребления памяти не должна привести к изменению формата пакетов. Но
это всё равно в несколько раз быстрее BLAKE2b.

@item
Из-за использования MTH, докачиваемые в online режиме файлы потребуют
чтения с диска только предшествующей части, а не полностью всего файла,
как было прежде.

@item
Добавлена @command{nncp-hash} утилита для вычисления MTH хэша файла.

@item
В шифрованных пакетах BLAKE2 KDF и XOF функции заменены на BLAKE3. Ещё
уменьшая количество примитивов. А также заголовок шифрованного файла
теперь является ассоциированными данными при шифровании.

@item
MultiCast Discovery использует
@verb{|ff02::4e4e:4350|} адрес вместо @verb{|ff02::1|}.

@item
@command{nncp-cfgenc} ошибочно трижды спрашивал парольную фразу при шифровании.

@item
@command{nncp-stat} выводит сводку о частично скачанных пакетах.

@item
Обновлены зависимые библиотеки.

@end itemize

@node Релиз 6.6.0
@subsection Релиз 6.6.0
@itemize

@item
@command{nncp-daemon}, @command{nncp-call} и @command{nncp-caller}
ожидают завершения всех процессов фоновой проверки контрольных сумм,
после того как соединение закрыто.

@item
Добавлена возможность определения адреса через multicast оповещение в
локальной сети, так называемый MCD (MultiCast Discovery).

@end itemize

@node Релиз 6.5.0
@subsection Релиз 6.5.0
@itemize

@item
Исправлено падение в @command{nncp-daemon} когда SP рукопожатие не было успешно.

@item
Исправлено возможное игнорирование плохого кода возврата автоматического tosser.

@item
Исправлена гонка при закрытии файловых дескрипторов во время завершения
работы online протокола, которая могла привести к ошибке записи
принятого фрагмента пакета.

@item
Убирать показ прогресса передачи пакетов когда вызов уже завершён в
@command{nncp-daemon}, @command{nncp-call} и @command{nncp-caller}.

@end itemize

@node Релиз 6.4.0
@subsection Релиз 6.4.0
@itemize

@item
Исправлена возможная гонка в online протоколе, приводящая к падению
программы.

@end itemize

@node Релиз 6.3.0
@subsection Релиз 6.3.0
@itemize

@item
Исправлено возможное падение программы во время показа прогресса online
протокола.

@end itemize

@node Релиз 6.2.1
@subsection Релиз 6.2.1
@itemize

@item
В трёх местах сообщений журналов по ошибке остались лишние @code{%s}.

@end itemize

@node Релиз 6.2.0
@subsection Релиз 6.2.0
@itemize

@item
Возвращена работоспособность @option{-autotoss*} опций @command{nncp-caller}.

@item
Очередной рефакторинг и упрощение системы журналирования.
Не должно быть видимых изменений для конечного пользователя.

@end itemize

@node Релиз 6.1.0
@subsection Релиз 6.1.0
@itemize

@item
Оптимизация: большинство команд теперь не держат открытыми файловые
дескрипторы. Прежде вы легко могли выйти за пределы максимально
допустимого количества открытых файлов, если у вас было много пакетов в
spool директории.

@item
Оптимизация: не закрывать файловый дескриптор файла который мы качаем.
Прежде каждый его кусочек приводил к дорогим open/close вызовам.

@item
Скачиваемые в режиме online файлы теперь сохраняются с @file{.nock}
суффиксом (non-checksummed), ожидая пока либо @command{nncp-check}, либо
online демоны не выполнят проверку целостности.

@item
Оптимизация: для файлов, скачивание которых не было продолжено, сразу же
вычисляет контрольная сумма, пропуская промежуточный @file{.nock} шаг.

@item
Возможность хранения заголовков зашифрованных пакетов в @file{.hdr}
файлах, рядом с самими пакетами. Это может существенно повысить скорость
получения списка пакетов на файловых системах с большим размером блока.

@end itemize

@node Релиз 6.0.0
@subsection Релиз 6.0.0
@itemize

@item
Журнал использует человеко-читаемый и легко обрабатываемый машиной
@url{https://www.gnu.org/software/recutils/, recfile} формат для своих
записей, вместо структурированных строчек RFC 3339. Старый формат
журналов не поддерживается @command{nncp-log}.

@item
Работоспособность @option{-autotoss*} опции с @option{-inetd} режимом
@command{nncp-daemon}.

@item
@option{when-tx-exists} опция вызова в конфигурационном файле позволяет
делать вызов только если имеются исходящие сообщения. Совмещённая с cron
выражением содержащим секунды, это можно использовать как возможность
вызова только при появлении исходящих пакетов.

@item
@command{nncp-cronexpr} команда позволяет проверить корректность и
ожидаемый результат от указанного cron выражения.

@end itemize

@node Релиз 5.6.0
@subsection Релиз 5.6.0
@itemize

@item
@option{-autotoss*} опции запускают tosser не после завершения вызова, а
во время него ежесекундно.

@item
В @option{calls} секции конфигурации появились опции
@option{autotoss}, @option{autotoss-doseen},
@option{autotoss-nofile}, @option{autotoss-nofreq},
@option{autotoss-noexec}, @option{autotoss-notrns}.
Вы можете настраивать опции автоматического tosser для каждого вызова.

@item
Использовать vendoring вместо переопределения @env{$GOPATH} во время
установки tarball, так как текущая минимальная версия Go это 1.12,
поддерживающая модули.

@end itemize

@node Релиз 5.5.1
@subsection Релиз 5.5.1
@itemize

@item
Уважать @env{$BINDIR}, @env{$INFODIR} и @env{$DOCDIR} переменные окружения
в @file{config} во время установки.

@end itemize

@node Релиз 5.5.0
@subsection Релиз 5.5.0
@itemize

@item
Исправления ошибок в @command{nncp-call(er)}/@command{nncp-daemon},
@command{nncp-bundle}, @command{nncp-stat} командах.

@item
У команды @command{nncp-rm} появились @option{-dryrun} и @option{-older} опции.

@item
У команды @command{nncp-exec} появились @option{-use-tmp} и
@option{-nocompress} опции. Несжатые пакеты не совместимы с предыдущими
версиями NNCP.

@item
У команд @command{nncp-call}, @command{nncp-caller} и @command{nncp-daemon}
появились @option{-autotoss*} опции для запуска tosser после завершения звонка.

@item
Обновлены зависимые библиотеки. Минимальная требуемая версия Go 1.12.

@end itemize

@node Релиз 5.4.1
@subsection Релиз 5.4.1
@itemize

@item
Исправлена ошибка с учётом @code{SENDMAIL} переменной при сборке.

@end itemize

@node Релиз 5.4.0
@subsection Релиз 5.4.0
@itemize

@item
Обновлены зависимые библиотеки.

@item
Система сборки переведена с Makefile-ов на @url{http://cr.yp.to/redo.html, redo}.
Это не должно повлиять на мейнтейнеров пакетов, так как минимальная
реализация @command{redo} включена в tarball.

@end itemize

@node Релиз 5.3.3
@subsection Релиз 5.3.3
@itemize

@item
Больше различных проверок в коде на ошибки.

@item
Обновлены зависимые библиотеки.

@end itemize

@node Релиз 5.3.2
@subsection Релиз 5.3.2
@itemize

@item
Исправлена некорректная логика @option{onlinedeadline} timeout-а, при
котором соединение могло не учитывать факты прихода пакетов и обрывать
связь.

@end itemize

@node Релиз 5.3.1
@subsection Релиз 5.3.1
@itemize

@item
Исправлена работоспособность @option{onlinedeadline} с адресами вызова
использующими внешние команды (@verb{#"|somecmd"#}).

@item
@command{nncp-stat} имеет опцию @option{-pkt} показывающую информацию по
каждому пакету в spool.

@end itemize

@node Релиз 5.3.0
@subsection Релиз 5.3.0
@itemize

@item
Сообщения прогресса содержат префикс, поясняющий выполняемое действие.

@item
Исправлено не происходящее дополнение (padding) handshake сообщений.

@item
Завершать все порождаемые в SP протоколе горутины, меньше утечек памяти.

@item
SP протокол порождает меньше вызовов записей (соответственно, и TCP
пакетов) в сокет.

@item
Проверять @option{onlinedeadline} и @option{maxonlinetime} ежесекундно,
независимо от чтения из сокета (раз в 10 секунд в худшем случае).

@item
Раз в минуту, если нет более никакого другого трафика, посылаются PING
пакеты в SP-соединении. Это позволит быстрее понимать что соединение
более не работоспособно.

@item
@command{nncp-toss} использует lock-file для предотвращения
одновременной обработки зашифрованных пакетов.

@end itemize

@node Релиз 5.2.1
@subsection Релиз 5.2.1
@itemize

@item
Исправлена обработка ошибки SP протокола, иногда вызывающая панику программы.

@end itemize

@node Релиз 5.2.0
@subsection Релиз 5.2.0
@itemize

@item
Большинство команд по умолчанию показывают однострочный прогресс
выполнения операции. Появились @option{-progress}, @option{-noprogress}
опции командной строки, @option{noprogress} опция конфигурационного
файла.

@item
Исправлен некорректный код возврата @command{nncp-check} команды,
который возвращал ошибку когда всё хорошо.

@item
Проверка свободного места для пакетов, во время выполнения
@command{nncp-bundle -rx}.

@end itemize

@node Релиз 5.1.2
@subsection Релиз 5.1.2
@itemize

@item
Исправлена @strong{критичная} уязвимость: аутентификация online нод
могла приводить к некорректной идентификации удалённой стороны, позволяя
скачивать чужие зашифрованные пакеты.

@item
Исправлена ошибка: в новосозданных конфигурационных файлах, приватный
публичный ключ Noise были поменяны местами, что приводило к
невозможности online аутентификации нод.

@item
Явная синхронизация (@code{fsync}) директорий для гарантированного
переименования файлов.

@end itemize

@node Релиз 5.1.1
@subsection Релиз 5.1.1
@itemize

@item
Исправлена работоспособность @command{nncp-file} с @option{-chunked 0} опцией.

@end itemize

@node Релиз 5.1.0
@subsection Релиз 5.1.0
@itemize

@item
@command{nncp-file} может отправлять директории, автоматически на лету
создавая pax архив.

@item
Во время создания исходящих сообщений проверяется наличие свободного
места на файловой системе.

@item
@option{freq}, @option{freqminsize}, @option{freqchunked} опции
конфигурационного файла заменены на структуру
@option{freq: @{path: @dots{}, minsize: @dots{}, chunked: @dots{}@}}.

@item
Добавлена @option{freq.maxsize} опция конфигурационного файл,
запрещающая ответ на файловый запрос больше заданного размера.

@item
Возможность оповещения об успешно выполненных командах (exec) через
@option{notify.exec} опцию конфигурационного файла.

@end itemize

@node Релиз 5.0.0
@subsection Релиз 5.0.0
@itemize

@item
@strong{Несовместимое} изменение формата конфигурационного файла:
YAML заменён на Hjson, из-за его гораздо большей простоты, без
заметной потери функционала и удобства.

@item
@strong{Несовместимое} изменение формата простых пакетов. Работа со
старыми версиями не поддерживается. @code{zlib} сжатие заменено на
@code{Zstandard}, так как оно значительно быстрее и эффективнее, не
смотря на то, что версия библиотеки ещё не проверена временем.

@item
Возможность соединяться с удалёнными нодами не только по TCP, но и через
pipe вызов сторонней команды.

@item
@command{nncp-cfgnew} генерирует конфигурационный файл с множеством
комментариев. Можно использовать @option{-nocomments} опцию для старого
поведения.

@item
Дубликаты имён файлов имеют суффикс @file{.CTR}, вместо @file{CTR},
чтобы избежать возможных коллизий с @file{.nncp.chunkCTR}.

@item
Возможность переопределить umask процесса через опцию конфигурационного
файла.

@item
По умолчанию файлы и директории создаются с 666/777 правами доступа,
позволяя управлять ими @command{umask}-ом.

@item
Обновлены зависимости.

@item
Полное использование go модулей для управления зависимостями
(используется @code{go.cypherpunks.ru/nncp/v5} namespace).

@item
Отмена автоматического использования более новых версий GNU GPL
(лицензия проекта GNU GPLv3-только).

@end itemize

@node Релиз 4.1
@subsection Релиз 4.1
@itemize
@item Восстановлена работоспособность на GNU/Linux системах и Go версии 1.10.
@end itemize

@node Релиз 4.0
@subsection Релиз 4.0
@itemize

@item
@strong{Несовместимое} изменение формата зашифрованных и eblob пакетов:
используется AEAD режим шифрования с 128 КиБ блоками, так как раньше
@command{nncp-toss} не проверял MAC зашифрованного пакета прежде чем
отсылать дешифрованные данные внешней команде. Старые версии не
поддерживаются.

@item
Проверка доступного места перед копированием во время работы
@command{nncp-xfer}, @command{nncp-daemon}, @command{nncp-call(er)}.

@item
@command{nncp-call} имеет возможность только показывать список пакетов
на удалённой машине, без их передачи.

@item
@command{nncp-call} имеет возможность передавать только чётко указанные пакеты.

@item
Восстановлена работоспособность @option{xxrate} настройки в
@option{calls} секции конфигурационного файла.

@item
Зависимые библиотеки обновлены.

@item
Небольшие исправления ошибок.

@item
Начало использования @code{go.mod} подсистемы.

@end itemize

@node Релиз 3.4
@subsection Релиз 3.4
@itemize
@item @command{nncp-daemon} может быть запущен как @command{inetd}-служба.
@end itemize

@node Релиз 3.3
@subsection Релиз 3.3
@itemize

@item
@command{nncp-daemon}, @command{nncp-call}, @command{nncp-caller}
проверяют существование @file{.seen} файла и расценивают его как то, что
файл уже был скачан. Возможно передача данных была осуществлена
сторонним способом и удалённая сторона должна быть оповещена об этом.

@item
Если более высокоприоритетный пакет попадает в спул, то
@command{nncp-daemon} добавит его в очередь отправки первым, прерывая
низкоприоритетные передачи.

@item
К средствам связанным с online-соединениями (@command{nncp-daemon},
@command{nncp-call}, @command{nncp-caller}) добавлен простой
ограничитель скорости.

@item
Возможность задания приоритета символьными обозначениями:
@verb{|NORMAL|}, @verb{|BULK+10|}, @verb{|PRIORITY-5|}, итд.

@item
Изменены значения приоритетов по-умолчанию:
для @command{nncp-exec} с 64 на 96,
для @command{nncp-freq} с 64 на 160,
для @command{nncp-file} с 196 на 224.

@end itemize

@node Релиз 3.2
@subsection Релиз 3.2
@itemize
@item
@strong{Несовместимое} изменение формата @emph{bundle} архивов и
работоспособность @command{nncp-bundle} команды с Go 1.10+. Bundle
должен быть корректным tar архивом, но Go 1.9 делал его недействительным
из-за длинных путей внутри. NNCP нечаянно был зависим от этой баги.
Явное добавление @file{NNCP/} директории в архив восстанавливает
работоспособность с корректными tar архивами.
@end itemize

@node Релиз 3.1
@subsection Релиз 3.1
@itemize
@item
Возможность отключать пересылку через промежуточные ноды используя
@verb{|-via -|} опцию командной строки.
@end itemize

@node Релиз 3.0
@subsection Релиз 3.0
@itemize

@item
@strong{Несовместимое} изменение формата простых пакетов. Работа со
старыми версиями не поддерживается.

@item
Добавлена возможность удалённого исполнения команд, путём
конфигурирования @option{exec} опции конфигурационного файла и
использования команды @command{nncp-exec}:
    @itemize
    @item
    Команда @command{nncp-mail} заменена более гибкой и широкой
    @command{nncp-exec}. Вместо вызова @verb{|nncp-mail NODE RECIPIENT|}
    нужно использовать @verb{|nncp-exec NODE sendmail RECIPIENT|}.
    @item
    @option{sendmail} опция конфигурационного файла заменена на более гибкую
    @option{exec}. @code{sendmail: [@dots{}]} нужно заменить на
    @code{exec: sendmail: [@dots{}]}.
    @end itemize

@item
Возможность переопределить @option{via} опцию конфигурации для целевого
узла через @option{-via} опцию командной строки для следующих команд:
@command{nncp-file}, @command{nncp-freq}, @command{nncp-exec}.

@item
Chunked файлы, меньшего размера чем указанный chunk, отправляются просто
в виде одного файла.

@item
Exec команды вызываются с дополнительными переменными окружения
@env{$NNCP_NICE} и @env{$NNCP_SELF}.

@item
Отправляемые файлы в ответ на запрос имеют приоритет указанный в запросе.
Указать их желаемый приоритет во время вызова @command{nncp-freq} можно
аргументом @option{-replynice}.

@item
Команде @command{nncp-toss} можно сказать не обрабатывать определённые
типы пакетов, за счёт опций @option{-nofile}, @option{-nofreq},
@option{-noexec}, @option{-notrns}.

@item
По-умолчанию @command{nncp-file} команда для
@option{-minsize}/@option{-chunked} опций использует
@option{FreqMinSize}/@option{FreqChunked} из конфигурационного файла.
Это можно отключить указав нулевое значение.

@end itemize

@node Релиз 2.0
@subsection Релиз 2.0
@itemize

@item
@strong{Несовместимое} изменение формата зашифрованных и eblob пакетов.
Работа со старыми версиями не поддерживается.

@item
Алгоритм шифрования Twofish заменён на ChaCha20. Он намного быстрее.
Одним криптографическим примитивом меньше.

@item
HKDF-BLAKE2b-256 KDF алгоритм заменён на BLAKE2Xb XOF. Ещё одним
криптографическим примитивом меньше (предполагая, что BLAKE2X
практически идентичен BLAKE2).

@end itemize

@node Релиз 1.0
@subsection Релиз 1.0
@itemize

@item
@strong{Несовместимое} изменение формата зашифрованных пакетов. Работа
со старыми версиями не поддерживается.

@item
@command{nncp-bundle} команда может создавать потоки зашифрованных
пакетов или потреблять их. Это полезно когда речь идёт о
@code{stdin}/@code{stdout} методах передачи (например запись на CD-ROM
без создания промежуточного подготовленного ISO образа или работа с
ленточными накопителями).

@item
@command{nncp-toss} команда может создавать @file{.seen} файлы,
предотвращая приём дублированных пакетов.

@item
В команде @command{nncp-call} разрешается иметь только одного
обработчика контрольной суммы в фоне. Это полезно когда тысячи маленьких
входящих пакетов могут создать много горутин.

@item
Возможность переопределить путь до spool директории и файла журнала
через аргумент командной строки или переменную окружения.

@item
@command{nncp-rm} команда может удалять все исходящие/входящие,
@file{.seen}, @file{.part}, @file{.lock} и временные файлы.

@end itemize

@node Релиз 0.12
@subsection Релиз 0.12
@itemize
@item Команда sendmail вызывается с @env{$NNCP_SENDER} переменной окружения.
@end itemize

@node Релиз 0.11
@subsection Релиз 0.11
@itemize
@item Вывод команды @command{nncp-stat} отсортирован по имени ноды.
@end itemize

@node Релиз 0.10
@subsection Релиз 0.10
@itemize
@item
@file{DST} аргумент @command{nncp-freq} команды теперь опционален.
По-умолчанию будет подставлен последний элемент @file{SRC} пути.
@end itemize

@node Релиз 0.9
@subsection Релиз 0.9
@itemize
@item
Исправлена обработка @option{-rx}/@option{-tx} опций @command{nncp-call}
команды. Они игнорировались.
@end itemize

@node Релиз 0.8
@subsection Релиз 0.8
@itemize
@item
Небольшое исправление ошибки в команде @command{nncp-file}, где опция
@option{-minsize} для передачи без разбиения на части была в байтах, а
не KiB-ах.
@end itemize

@node Релиз 0.7
@subsection Релиз 0.7
@itemize

@item
Возможность предоставлять данные для @command{nncp-file} через
стандартный ввод, используя временный зашифрованный файл для этого.

@item
Появилась возможность передачи файлов разбитых на части, с сопутствующей
@command{nncp-reass} командой и @option{freqchunked} опцией
конфигурационного файла. Полезно для передачи больших файлов через
маленькие устройства хранения.

@item
@option{freqminsize} опция конфигурационного файла, аналогичная
@option{-minsize}.

@item
Опция @option{-force} команды @command{nncp-xfer} переименована в
@option{-mkdir} для ясности.

@item
Опция @option{-minsize} задаётся в KiB, а не байтах, для удобства.

@item
Команда @command{nncp-newcfg} переименована в @command{nncp-cfgnew},
а @command{nncp-mincfg} в @command{nncp-cfgmin}, для того чтобы они
имели общий префикс и были сгруппированы для удобства.

@item
Появилась команда @command{nncp-cfgenc}, позволяющая
шифровать/дешифровать конфигурационный файл, чтобы безопасно его хранить
без использования OpenPGP или других подобных инструментов.

@item
Обновлены зависимые криптографические библиотеки.

@end itemize

@node Релиз 0.6
@subsection Релиз 0.6
@itemize
@item Появилась небольшая команда @command{nncp-rm}.
@item Обновлены зависимые криптографические библиотеки.
@end itemize

@node Релиз 0.5
@subsection Релиз 0.5
@itemize
@item
Тривиальное небольшое исправление в значениях приоритетов по-умолчанию в
@command{nncp-file} и @command{nncp-freq} командах.
@end itemize

@node Релиз 0.4
@subsection Релиз 0.4
@itemize

@item
Небольшое исправление в @command{nncp-call}, @command{nncp-caller},
@command{nncp-daemon}: иногда они могли падать с segmentation fault
ошибкой (данные не терялись).

@item
@command{nncp-newnode} переименована в @command{nncp-newcfg} --
это короче и удобнее для использования.

@item
Появилась команда @command{nncp-mincfg}: вспомогательная утилита
позволяющая создать минималистичный урезанный конфигурационный файл без
приватных ключей, что полезно во время использования @command{nncp-xfer}.

@end itemize

@node Релиз 0.3
@subsection Релиз 0.3
@itemize
@item Исправлена совместимость с Go 1.6.
@end itemize

@node Релиз 0.2
@subsection Релиз 0.2
@itemize

@item
@strong{Несовместимое} изменение формата пакета (магическое число тоже
изменено): поле размера пакета шифруется и не посылается в открытом виде.

@item
@option{-minsize} опция даёт возможность автоматически дополнять
исходящие пакеты до указанного минимального размера.

@item
@command{nncp-daemon} и @command{nncp-call}/@command{nncp-caller} всегда
в фоне проверяют появление исходящих @emph{tx} пакетов пока подключены.
Удалённая сторона сразу же оповещается об этом.

@item
@option{-onlinedeadline} опция даёт возможность выставления timeout-а на
неактивность в online соединении, когда оно должно быть отключено. Она
может быть использована для сохранения соединения на долгое время.

@item
@option{-maxonlinetime} опция даёт возможность указания максимального
возможного времени жизни соединения.

@item
Появилась @command{nncp-caller} команда: клиент TCP-демона работающий по
cron-у.

@item
@command{nncp-pkt} команда может разжимать данные.

@end itemize
